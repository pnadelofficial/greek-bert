Starting
Thu Jan  8 04:17:54 PM EST 2026
Module loading
Activating env
Starting BERT Training
Training on 8 GPUs with mixed precision
Local rank: 0, Global rank: 0
TensorBoard logs will be saved to: ./runs
Run: tensorboard --logdir=./runs
Loading dataset...
Dataset info:
  Type: <class 'datasets.arrow_dataset.Dataset'>
  Length: 1360380, type: <class 'int'>
  Features: {'input_ids': List(Value('int32')), 'attention_mask': List(Value('int8')), 'labels': List(Value('int64'))}

Sample data:
  input_ids: type=<class 'torch.Tensor'>, dtype=torch.int64
  attention_mask: type=<class 'torch.Tensor'>, dtype=torch.int64
  labels: type=<class 'torch.Tensor'>, dtype=torch.int64
Initializing model...
Tokenizing dataset...
DEBUG: num_epochs = 20, type = <class 'int'>
DEBUG: len(train_dataloader) = 5314, type = <class 'int'>
DEBUG: gradient_accumulation_steps = 1, type = <class 'int'>
DEBUG: num_training_steps = 106280, type = <class 'int'>
DEBUG: lr = 5e-5, type = <class 'str'>
DEBUG: max_lr = 1e-4, type = <class 'str'>
DEBUG: pct_start = 0.05, type = <class 'float'>
DEBUG: weight_decay = 0.01, type = <class 'float'>

Starting training for 20 epochs
Total training steps: 106280
Steps per epoch: 5314
Effective batch size: 256
Mixed precision: True
Gradient accumulation steps: 1

Epoch 1/20
Epoch 1 - Average Loss: 2.7894
Running validation...
Validation Loss: 2.3287

Epoch 2/20
Epoch 2 - Average Loss: 2.3574
Running validation...
Validation Loss: 2.1812

Epoch 3/20
Epoch 3 - Average Loss: 2.2494
Running validation...
Validation Loss: 2.0998

Epoch 4/20
Epoch 4 - Average Loss: 2.1840
Running validation...
Validation Loss: 2.0446

Epoch 5/20
Epoch 5 - Average Loss: 2.1362
Checkpoint saved to: ./checkpoints/checkpoint_epoch_5.pt
Running validation...
Validation Loss: 2.0026

Epoch 6/20
Epoch 6 - Average Loss: 2.1002
Running validation...
Validation Loss: 1.9667

Epoch 7/20
Epoch 7 - Average Loss: 2.0688
Running validation...
Validation Loss: 1.9423

Epoch 8/20
Epoch 8 - Average Loss: 2.0398
Running validation...
Validation Loss: 1.9148

Epoch 9/20
Epoch 9 - Average Loss: 2.0163
Running validation...
Validation Loss: 1.8933

Epoch 10/20
Epoch 10 - Average Loss: 1.9946
Checkpoint saved to: ./checkpoints/checkpoint_epoch_10.pt
Running validation...
Validation Loss: 1.8755

Epoch 11/20
Epoch 11 - Average Loss: 1.9754
Running validation...
Validation Loss: 1.8576

Epoch 12/20
Epoch 12 - Average Loss: 1.9602
Running validation...
Validation Loss: 1.8446

Epoch 13/20
Epoch 13 - Average Loss: 1.9496
Running validation...
Validation Loss: 1.8304

Epoch 14/20
Epoch 14 - Average Loss: 1.9354
Running validation...
Validation Loss: 1.8207

Epoch 15/20
Epoch 15 - Average Loss: 1.9262
Checkpoint saved to: ./checkpoints/checkpoint_epoch_15.pt
Running validation...
Validation Loss: 1.8141

Epoch 16/20
Epoch 16 - Average Loss: 1.9157
Running validation...
Validation Loss: 1.8056

Epoch 17/20
Epoch 17 - Average Loss: 1.9100
Running validation...
Validation Loss: 1.8005

Epoch 18/20
Epoch 18 - Average Loss: 1.9071
Running validation...
Validation Loss: 1.7978

Epoch 19/20
Epoch 19 - Average Loss: 1.9042
Running validation...
Validation Loss: 1.7963

Epoch 20/20
Epoch 20 - Average Loss: 1.9047
Checkpoint saved to: ./checkpoints/checkpoint_epoch_20.pt
Running validation...
Validation Loss: 1.7988

Training complete! Final model saved to: ./checkpoints/final_model.pt
Training finished
Converting model to HuggingFace format
Post-training with spaCy
Activating env
Starting post-training with spaCy
[38;5;4mâ„¹ Saving to output directory: output[0m
[38;5;4mâ„¹ Using GPU: 0[0m
[1m
=========================== Initializing pipeline ===========================[0m
[38;5;2mâœ” Initialized pipeline[0m
[1m
============================= Training pipeline =============================[0m
[38;5;4mâ„¹ Pipeline: ['transformer', 'tagger', 'morphologizer',
'trainable_lemmatizer', 'parser'][0m
[38;5;4mâ„¹ Initial learn rate: 0.0[0m
E    #       LOSS TRANS...  LOSS TAGGER  LOSS MORPH...  LOSS TRAIN...  LOSS PARSER  TAG_ACC  POS_ACC  MORPH_ACC  LEMMA_ACC  DEP_UAS  DEP_LAS  SENTS_F  SCORE 
---  ------  -------------  -----------  -------------  -------------  -----------  -------  -------  ---------  ---------  -------  -------  -------  ------
  0       0        1440.44      1483.22        1483.98        1484.80      2640.14     0.00    18.20       0.99      20.31    12.24     3.42     0.06    0.09
  1     200      358300.72    353950.32      355626.64      356594.75    379440.33    16.73    14.16      32.12      20.31    48.97    30.83    18.05    0.25
  2     400      239439.83    283576.02      320254.46      335063.11    257091.14    45.47    86.70      46.34      31.27    68.71    59.64    62.81    0.51
  3     600      215903.60    137799.13      208551.12      259627.06    205907.40    80.81    94.72      74.79      54.22    72.44    65.04    69.00    0.72
  4     800      212417.28     60292.73      114375.57      194890.87    181351.60    90.20    96.62      87.83      61.33    75.56    69.01    76.89    0.79
  5    1000      197572.88     36128.10       70838.63      161798.88    156928.35    92.08    97.09      90.74      64.65    77.82    71.69    78.99    0.81
  6    1200      193952.36     27098.96       53545.98      145544.89    144572.31    93.37    97.35      92.51      67.39    79.29    73.58    80.07    0.83
  7    1400      184654.34     21546.00       43456.11      130830.31    131892.05    94.19    97.55      93.27      69.91    79.94    74.45    80.31    0.84
  8    1600      177062.90     18412.73       36821.00      121836.35    122092.57    94.61    97.55      93.88      71.65    80.72    75.46    82.35    0.85
  9    1800      168827.75     15105.26       32082.97      109984.73    114491.11    94.87    97.74      94.32      73.15    81.12    75.93    83.57    0.86
 10    2000      159390.99     13513.84       28123.40      101966.17    105828.05    95.04    97.79      94.51      74.42    82.03    77.09    83.07    0.86
 11    2200      154219.78     11615.45       25584.26       93002.04     99685.60    95.02    97.78      94.65      75.70    82.43    77.50    84.79    0.87
 12    2400      144155.82     10356.35       22825.06       85129.06     92044.85    95.21    97.79      94.89      76.72    82.18    77.38    83.48    0.87
 13    2600      137480.79      9397.57       20865.13       78918.87     88250.46    95.35    97.87      94.79      77.84    82.40    77.69    84.32    0.87
 14    2800      132550.16      8284.53       19274.52       73032.37     83535.56    95.31    97.81      94.78      78.76    82.61    77.91    84.74    0.88
 15    3000      126072.06      7461.92       17482.76       67120.80     79116.41    95.32    97.85      94.90      79.40    83.03    78.38    84.93    0.88
 16    3200      118551.83      6597.08       15912.21       61801.56     73222.48    95.35    97.87      94.98      80.08    82.63    78.03    83.83    0.88
 17    3400      115573.40      6303.13       15024.51       57057.72     71075.37    95.43    97.92      95.00      80.67    83.06    78.55    85.16    0.88
 18    3600      113809.96      5532.99       13825.10       52731.27     69570.93    95.38    97.83      95.05      81.29    83.02    78.56    84.10    0.88
 20    3800      101791.61      4954.90       12449.75       47593.88     63162.71    95.32    97.79      95.05      81.86    83.13    78.61    85.22    0.89
 21    4000       98339.08      4545.30       11636.99       43834.41     61252.33    95.36    97.86      95.11      82.35    83.46    79.02    84.60    0.89
 22    4200       96160.66      4142.71       10764.20       40358.10     59281.32    95.32    97.84      95.20      82.63    83.53    79.14    84.60    0.89
 23    4400       91988.05      3784.97       10060.55       36822.22     56365.03    95.46    97.92      95.07      82.89    83.58    79.19    84.79    0.89
 24    4600       86817.01      3429.72        9351.71       33584.14     54295.03    95.40    97.79      95.19      83.29    83.61    79.25    85.13    0.89
 25    4800       81688.63      3064.83        8456.68       30179.68     51582.97    95.36    97.77      95.23      83.58    83.50    79.25    84.51    0.89
 26    5000       80041.72      2770.16        7784.16       27686.72     50419.08    95.51    97.92      95.24      83.85    83.91    79.65    86.67    0.89
 27    5200       74340.59      2660.27        7274.46       24973.78     47913.45    95.51    97.96      95.23      84.13    83.82    79.49    85.97    0.89
 28    5400       73871.13      2334.92        6680.69       22683.61     47315.34    95.48    97.89      95.21      84.36    83.73    79.48    85.32    0.90
 29    5600       68990.84      2237.80        6331.88       20488.58     44145.75    95.50    97.91      95.17      84.63    83.88    79.51    86.30    0.90
 30    5800       65535.12      1985.76        5766.41       18951.58     43059.38    95.51    97.91      95.22      84.64    83.86    79.60    85.87    0.90
 31    6000       62612.52      1730.60        5220.39       16747.05     41564.14    95.44    97.83      95.26      84.76    83.89    79.58    86.36    0.90
 32    6200       60242.50      1752.29        5035.73       15458.03     39956.45    95.45    97.84      95.20      84.79    83.98    79.63    86.10    0.90
 33    6400       59607.15      1516.60        4578.35       14103.83     39306.23    95.51    97.86      95.29      84.79    84.07    79.73    86.73    0.90
 34    6600       56628.29      1351.15        4194.40       12738.02     38085.25    95.40    97.82      95.22      85.08    84.09    79.71    86.19    0.90
 35    6800       53665.05      1229.44        3906.53       11377.84     36575.52    95.46    97.86      95.32      85.26    84.11    79.72    86.33    0.90
 36    7000       51702.89      1259.07        3593.95       10605.72     36293.67    95.56    97.88      95.32      85.23    84.17    79.88    86.50    0.90
 37    7200       49985.16      1059.44        3381.90        9404.05     34635.43    95.57    97.94      95.29      85.30    83.94    79.59    86.19    0.90
 38    7400       49676.31      1046.76        3207.99        8848.16     34410.94    95.53    97.89      95.34      85.32    84.19    79.98    86.21    0.90
 39    7600       46299.52       975.64        2922.32        8098.97     33383.20    95.53    97.94      95.27      85.53    84.24    80.06    86.41    0.90
 40    7800       46213.97       877.91        2680.95        6919.64     33024.98    95.48    97.87      95.34      85.48    84.38    80.12    85.84    0.90
 42    8000       43240.06       761.04        2367.05        6318.80     31539.89    95.45    97.83      95.26      85.55    84.20    80.02    85.64    0.90
 43    8200       41629.64       772.11        2287.46        5849.60     31457.74    95.52    97.89      95.34      85.64    84.21    79.99    86.33    0.90
 44    8400       40523.59       684.41        2076.15        5354.07     30583.04    95.46    97.86      95.27      85.64    84.31    80.05    85.94    0.90
 45    8600       37048.82       637.33        1944.03        4868.04     29852.50    95.49    97.87      95.27      85.65    84.06    79.97    86.11    0.90
 46    8800       35802.41       622.05        1865.78        4519.51     28849.73    95.55    97.91      95.35      85.62    84.23    79.98    86.45    0.90
 47    9000       35300.71       550.57        1738.65        4094.01     28898.35    95.42    97.78      95.32      85.63    84.12    79.90    86.29    0.90
 48    9200       33684.76       497.70        1550.35        3741.78     28657.85    95.45    97.82      95.32      85.57    84.26    80.02    86.40    0.90
 49    9400       32291.71       506.47        1500.09        3379.86     27685.70    95.52    97.85      95.34      85.78    84.41    80.24    86.36    0.90
 50    9600       31585.93       434.50        1337.51        3155.45     27438.86    95.46    97.81      95.29      85.68    84.37    80.15    86.08    0.90
 51    9800       28944.84       468.71        1302.09        2933.20     27010.16    95.55    97.88      95.33      85.71    84.41    80.20    86.20    0.90
 52   10000       30043.43       376.67        1174.76        2616.79     27252.16    95.47    97.84      95.33      85.83    84.18    79.95    85.88    0.90
 53   10200       29474.77       390.54        1186.36        2513.36     26470.72    95.54    97.92      95.38      85.81    84.35    80.20    86.55    0.90
 54   10400       27170.87       382.19        1035.21        2148.54     25745.53    95.57    97.91      95.36      85.82    84.30    80.10    86.80    0.90
 55   10600       26333.92       389.63        1032.78        2173.19     25685.07    95.53    97.90      95.34      85.89    84.28    80.14    86.18    0.90
 56   10800       24538.79       332.16         912.48        1962.05     25322.75    95.53    97.93      95.36      85.92    84.66    80.46    86.91    0.90
 57   11000       24693.41       314.59         871.98        1776.78     25534.04    95.40    97.76      95.31      85.84    84.34    80.13    86.58    0.90
 58   11200       24928.93       307.24         833.29        1690.77     25615.31    95.55    97.85      95.33      85.93    84.29    80.03    86.39    0.90
 60   11400       23828.52       267.54         782.28        1536.40     25674.35    95.50    97.84      95.32      85.85    84.56    80.40    86.08    0.90
 61   11600       23045.84       262.78         749.91        1462.28     24730.23    95.59    97.88      95.38      85.97    84.48    80.29    87.21    0.90
 62   11800       22540.29       226.29         674.19        1333.89     24817.46    95.46    97.80      95.39      85.96    84.39    80.28    87.20    0.90
 63   12000       21602.97       239.66         640.03        1326.48     24359.33    95.56    97.87      95.39      85.91    84.46    80.32    86.77    0.90
 64   12200       22272.45       230.85         604.06        1158.73     24415.52    95.51    97.80      95.34      86.00    84.52    80.38    86.10    0.90
 65   12400       22680.11       233.58         594.85        1139.25     25035.26    95.54    97.94      95.34      86.01    84.66    80.45    86.27    0.90
 66   12600       18466.82       198.22         495.48        1035.65     23681.64    95.49    97.83      95.34      86.01    84.63    80.47    86.69    0.90
 67   12800       19735.42       201.65         531.18        1028.64     24177.05    95.54    97.88      95.31      86.07    84.54    80.26    86.31    0.90
 68   13000       19055.86       191.91         505.92         926.67     23712.27    95.55    97.89      95.33      86.01    84.74    80.56    86.79    0.90
 69   13200       19188.75       190.94         453.68         921.15     23888.13    95.51    97.84      95.33      86.05    84.64    80.50    87.27    0.90
 70   13400       19747.03       168.65         425.36         875.69     23812.40    95.52    97.86      95.31      86.00    84.53    80.45    87.46    0.90
 71   13600       17735.67       140.04         405.24         805.55     23409.10    95.56    97.89      95.36      86.05    84.52    80.38    86.73    0.90
 72   13800       17759.11       152.10         402.17         765.76     23726.33    95.61    97.90      95.36      85.95    84.73    80.66    86.81    0.90
 73   14000       16798.97       127.60         372.46         752.12     22966.92    95.54    97.88      95.36      86.08    84.67    80.57    86.75    0.90
 74   14200       16738.55       166.52         382.78         682.18     23393.13    95.64    97.96      95.37      86.00    84.70    80.61    86.78    0.90
 75   14400       17289.03       148.01         344.03         643.56     22979.23    95.56    97.88      95.38      86.07    84.72    80.65    87.21    0.90
 76   14600       15040.26       152.11         369.60         642.84     23056.43    95.59    97.87      95.42      86.10    84.70    80.55    87.25    0.90
 77   14800       14872.10       123.76         315.70         600.44     22402.51    95.52    97.84      95.41      86.10    84.70    80.64    86.87    0.90
 79   15000       15789.52       126.29         303.16         577.37     22654.26    95.57    97.88      95.40      86.08    84.68    80.61    86.70    0.90
 80   15200       15125.96       109.57         291.86         551.71     22700.58    95.52    97.87      95.37      86.02    84.57    80.51    87.04    0.90
 81   15400       14483.82       107.97         284.32         490.59     22587.37    95.59    97.94      95.39      86.14    84.66    80.65    86.89    0.90
 82   15600       14457.96       110.76         271.83         497.54     22612.43    95.56    97.87      95.39      86.06    84.67    80.65    87.17    0.90
 83   15800       13690.64       107.61         259.72         480.93     22401.10    95.63    97.93      95.42      86.08    84.72    80.58    86.93    0.90
 84   16000       13805.78       109.41         254.39         454.70     22271.90    95.58    97.88      95.40      86.03    84.79    80.72    86.84    0.90
 85   16200       13475.95       103.37         225.71         425.26     22201.50    95.56    97.93      95.37      86.08    84.88    80.78    86.82    0.90
 86   16400       13089.34        99.30         252.11         424.18     22199.77    95.55    97.86      95.39      86.10    84.81    80.81    86.88    0.90
 87   16600       13469.93        89.02         224.94         401.93     22237.01    95.52    97.89      95.36      86.07    84.94    80.89    87.08    0.90
 88   16800       12787.39        86.86         206.05         422.38     22195.11    95.54    97.89      95.36      86.09    84.83    80.74    87.07    0.90
 89   17000       12810.12        80.20         206.19         380.92     21737.50    95.52    97.91      95.43      86.05    84.79    80.73    86.60    0.90
 90   17200       12265.34        89.52         222.26         386.62     22019.99    95.58    97.94      95.36      86.10    84.81    80.78    86.97    0.90
 91   17400       11482.55        74.43         177.81         362.81     21267.98    95.52    97.93      95.36      86.10    84.84    80.86    87.21    0.90
 92   17600       12097.87        87.62         203.16         358.79     22275.40    95.59    97.95      95.40      86.15    84.91    80.85    86.93    0.90
 93   17800       11934.11        60.66         162.63         353.57     21933.90    95.56    97.91      95.41      86.09    84.88    80.84    86.84    0.90
 94   18000       12715.50        73.74         185.65         346.68     22356.32    95.61    97.94      95.38      86.13    84.86    80.85    86.97    0.90
 95   18200       11445.29        68.26         163.52         287.87     21714.05    95.57    97.94      95.39      86.12    84.87    80.87    86.73    0.90
 96   18400       11446.67        70.30         179.24         315.85     21658.94    95.54    97.91      95.38      86.14    84.89    80.88    86.70    0.90
 97   18600       11162.60        73.95         157.50         300.20     21596.93    95.53    97.91      95.39      86.14    84.79    80.75    87.03    0.90
 98   18800       11040.36        62.37         144.79         298.80     21590.41    95.51    97.86      95.39      86.14    84.87    80.89    86.99    0.90
 99   19000       11211.23        56.05         143.70         297.98     22205.46    95.56    97.92      95.40      86.15    84.83    80.83    86.73    0.90
101   19200       10320.82        76.73         160.04         285.97     21396.53    95.55    97.90      95.37      86.14    84.85    80.83    86.86    0.90
[38;5;2mâœ” Saved pipeline to output directory[0m
output/model-last
Post-training finished
Evaluating spaCy model
[38;5;4mâ„¹ Using GPU: 0[0m
[1m
================================== Results ==================================[0m

TOK      99.99
TAG      94.56
POS      97.29
MORPH    94.69
LEMMA    84.47
UAS      84.21
LAS      80.10
SENT P   86.80
SENT R   86.61
SENT F   86.70
SPEED    12020

[1m
============================== MORPH (per feat) ==============================[0m

                P        R        F
Mood        98.67    98.41    98.54
Number      99.06    98.74    98.90
Person      98.37    97.41    97.89
Tense       97.71    97.54    97.62
VerbForm    99.21    99.10    99.16
Voice       98.16    97.99    98.07
Case        98.19    97.89    98.04
Gender      95.22    95.11    95.17
Aspect      97.91    98.10    98.00
Degree      94.58    95.57    95.07
PronType    98.89    98.53    98.71
Definite    99.61    99.50    99.55
Reflex     100.00   100.00   100.00
Polarity    99.54    98.64    99.09
Poss        91.67    84.62    88.00

[1m
=============================== LAS (per type) ===============================[0m

                  P       R       F
root          90.33   90.10   90.21
advmod        76.99   75.65   76.31
nsubj         80.60   81.84   81.21
det           92.58   91.86   92.22
nmod          72.27   70.96   71.61
obj           81.55   81.05   81.30
advcl         72.90   75.20   74.03
cc            84.04   85.00   84.52
conj          72.56   71.80   72.18
amod          71.14   57.45   63.57
cop           74.11   76.53   75.30
obl           73.58   74.01   73.80
case          94.83   94.88   94.85
xcomp         60.81   59.61   60.20
csubj         51.02   52.08   51.55
mark          90.53   88.97   89.74
ccomp         66.26   65.46   65.86
dep            0.00    0.00    0.00
acl           54.46   51.35   52.86
discourse     84.79   84.90   84.84
vocative      66.06   62.07   64.00
iobj          49.53   53.54   51.46
appos         45.68   42.53   44.05
parataxis     10.53    6.25    7.84
nummod        78.48   84.93   81.58
orphan        26.32   15.38   19.42
nsubj:outer    0.00    0.00    0.00
obl:arg       82.13   83.59   82.85
nsubj:pass    80.00   80.00   80.00
obl:agent     85.71   54.55   66.67
dislocated    29.41   18.52   22.73
advcl:cmp     56.25   42.86   48.65
fixed         80.00   72.73   76.19
csubj:pass     0.00    0.00    0.00
aux            0.00    0.00    0.00
aux:pass       0.00    0.00    0.00
flat:name     85.71   85.71   85.71

[38;5;2mâœ” Saved results to output/eval_results.json[0m
Evaluation finished
